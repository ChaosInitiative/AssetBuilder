{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://chaosinitiative.com/cas/schemas/root.json",

    "type": "object",
    "title": "Configuration",
    "description": "Root AssetBuilder configuration",
    
    "required": ["options", "jobs"],
    "properties": {
        "options": {
            "type": "object",
            "title": "Options",
            "description": "Global configuration options",
            
            "required": ["project"],
            "properties": {
                "project": {
                    "type": "string",
                    "description": "The project namespace for your game or mod.",
                    "examples": ["p2ce"]
                },
                "tooling": {
                    "type": "object",
                    "title": "Tooling",
                    "description": "Options to configure Source Engine tooling functionality.",
                    "properties": {
                        "enable": {
                            "type": "boolean",
                            "description": "Whether or not to enable tooling functionality."
                        },
                        "path": {
                            "type": "string",
                            "description": "The location to source tooling binaries from."
                        },
                        "appid": {
                            "type": "integer",
                            "description": "The AppID of the app to source tooling binaries from."
                        }
                    }
                }
            }
        },
        "jobs": {
            "type": "object",
            "title": "Jobs",
            "description": "Key-value dictionary of jobs to run.",
            "additionalProperties": { "$ref": "#/definitions/job" }
        }
    },

    "definitions": {
        "job": {
            "title": "Job",
            "description": "A unique execution unit that contains a number of steps.",

            "type": "object",
            "required": ["steps"],
            "properties": {
                "on": {
                    "type": "array",
                    "title": "Build Types",
                    "description": "The build types this job should run for.",

                    "examples": [["staging", "release"]],
                    "items": {
                        "type": "string",
                        "enum": ["trunk", "staging", "release"]
                    }
                },
                "steps": {
                    "type": "array",
                    "title": "Steps",
                    "description": "The steps to this job should run.",
                    "items": { "$ref": "#/definitions/step" }
                }
            }
        },
        "step": {
            "title": "Step",
            "description": "The step to run.",

            "type": "object",
            "required": ["name", "uses"],
            "properties": {
                "id": {
                    "type": "string",
                    "title": "Identifier",
                    "description": "Optional machine identifier for this step, to allow referencing it from conditionals.",
                    "examples": ["foobar"]
                },
                "name": {
                    "type": "string",
                    "title": "Name",
                    "description": "A descriptive name for this step.",
                    "examples": ["Foo Bar"]
                },
                "uses": {
                    "type": "string",
                    "title": "Module",
                    "description": "The subsystem module to load.",
                    "examples": ["buildsys"]
                },
                "with": {
                    "type": "object",
                    "title": "Options",
                    "description": "Options to pass to the subsystem.",
                    "additionalProperties": true,
                    "examples": [{"foobar": 1234}]
                }
            }
        }
    }
}